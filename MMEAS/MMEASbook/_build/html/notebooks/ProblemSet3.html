
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Problem Set 3 &#8212; Mathematics Methods for Engineering and Applied Science</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Problem Set 2" href="ProblemSet2.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Mathematics Methods for Engineering and Applied Science</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Mathematical Methods in Engineering and Applied Science
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ProblemSet1.html">
   Problem Set 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ProblemSet2.html">
   Problem Set 2
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Problem Set 3
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/ProblemSet3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks/ProblemSet3.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/notebooks/ProblemSet3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-1">
   Problem 1
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution">
     Solution
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a">
       (a)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#b">
       (b)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#c">
       (c)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-2">
   Problem 2
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Solution
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       (a)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       (b)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       (c)
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-3">
   Problem 3
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Solution
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-4">
   Problem 4
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     Solution
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problem-5">
   Problem 5
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     Solution
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="problem-set-3">
<h1>Problem Set 3<a class="headerlink" href="#problem-set-3" title="Permalink to this headline">¶</a></h1>
<div class="section" id="problem-1">
<h2>Problem 1<a class="headerlink" href="#problem-1" title="Permalink to this headline">¶</a></h2>
<p>The e-value problem for longitudinal waves in an elastic rod is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
u'' + k^{2}u = 0, \\
u(0) = 0, \hspace{3mm} u_{x}(l) = 0.
\end{split}\]</div>
<p>(a) Explain the physical meaning of the second boundary condition.</p>
<p>(b) Solve the problem analytically to find <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(u\)</span>.</p>
<p>(c) Plot the eigenfunctions that correspond to the lowest three eigenvalues.</p>
<div class="section" id="solution">
<h3>Solution<a class="headerlink" href="#solution" title="Permalink to this headline">¶</a></h3>
<div class="section" id="a">
<h4>(a)<a class="headerlink" href="#a" title="Permalink to this headline">¶</a></h4>
<p>The meaning of the second boundary condition - derivative of <span class="math notranslate nohighlight">\(u\)</span> with respect to <span class="math notranslate nohighlight">\(x\)</span> - can be understood, if we “plot” the function <span class="math notranslate nohighlight">\(u(x)\)</span>. It has to intersect the line <span class="math notranslate nohighlight">\(x = l\)</span> normally, meaning that the difference in displacement of any two points at the point <span class="math notranslate nohighlight">\(l\)</span> neighborhood tends to zero. In other words, point <span class="math notranslate nohighlight">\(l\)</span> will be an antinode of the standing waves (eigenfunctions).</p>
</div>
<div class="section" id="b">
<h4>(b)<a class="headerlink" href="#b" title="Permalink to this headline">¶</a></h4>
<p>The analytical solution to this problem is as follows.</p>
<ol class="simple">
<li><p>Write down the characteristic equation and find the general solution:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\lambda ^{2} + k^{2} = 0, \\
\lambda = \pm ik, \hspace{3mm} \Rightarrow \hspace{3mm} u_{g}(x) = C_{1}\cos{(kx)} + C_{2}\sin{(kx)}.
\end{split}\]</div>
<ol class="simple">
<li><p>Plug <span class="math notranslate nohighlight">\(u_{g}\)</span> into boundary conditions:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
u(0) = 0, \hspace{3mm} \Rightarrow \hspace{3mm} C_{1} = 0, \\
u'_{l} = 0, \hspace{3mm} \Rightarrow \hspace{3mm} kl = \frac{2n+1}{2} \pi, \\
k = \frac{(2n+1)\pi}{2l}.
\end{split}\]</div>
<ol class="simple">
<li><p>Write down the final form of the solution:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
u(x) = C_{2}\sin{(\frac{(2n+1)\pi}{2l}x)}.
\]</div>
</div>
<div class="section" id="c">
<h4>(c)<a class="headerlink" href="#c" title="Permalink to this headline">¶</a></h4>
<p>Now we plot the function for the lowest three eigenvalues:</p>
<div class="math notranslate nohighlight">
\[
n = (0, 1, 2), \hspace{3mm} 
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;svg&#39;

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">abc</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">copy</span>

<span class="n">C2</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;C2, pi, n, l, x&#39;</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>

<span class="n">ns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="k">for</span> <span class="n">n_</span> <span class="ow">in</span> <span class="n">ns</span><span class="p">:</span>
    <span class="n">f_</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">n</span><span class="p">:</span> <span class="n">n_</span><span class="p">,</span> <span class="n">l</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">})</span>
    <span class="n">func</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_</span><span class="p">)</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">(</span><span class="s1">&#39;$0$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">frac</span><span class="si">{2}{5}</span><span class="s1">l$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">frac</span><span class="si">{1}{2}</span><span class="s1">l$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">frac</span><span class="si">{2}{3}</span><span class="s1">l$&#39;</span><span class="p">,</span>
            <span class="s1">&#39;$l</span><span class="se">\\</span><span class="s1">hspace</span><span class="si">{1}</span><span class="s1">$&#39;</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="s1">&#39;$-C_2$&#39;</span><span class="p">,</span> <span class="s1">&#39;$0$&#39;</span><span class="p">,</span> <span class="s1">&#39;$C_2$&#39;</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Eigenfunctions&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$u(x)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;$n = 0$&#39;</span><span class="p">,</span> <span class="s1">&#39;$n = 1$&#39;</span><span class="p">,</span> <span class="s1">&#39;$n = 2$&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s1">&#39;zero&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s1">&#39;zero&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ProblemSet3_3_0.svg" src="../_images/ProblemSet3_3_0.svg" /></div>
</div>
</div>
</div>
</div>
<div class="section" id="problem-2">
<h2>Problem 2<a class="headerlink" href="#problem-2" title="Permalink to this headline">¶</a></h2>
<p>Concider elastic waves in a nonuniform rod between <span class="math notranslate nohighlight">\(x = 0\)</span> and <span class="math notranslate nohighlight">\(x = l\)</span>, as in the lecture nodes. The density of the rod varies with space as <span class="math notranslate nohighlight">\(\rho = \rho_{0} (1 - \epsilon \frac{x(l-x)}{l^{2}})\)</span>, where <span class="math notranslate nohighlight">\(\rho_0\)</span> is constant and <span class="math notranslate nohighlight">\(\epsilon \ge 0\)</span> is some number. The corresponding eigenvalue problem is:</p>
<div class="math notranslate nohighlight">
\[
\phi'' + k_{0}^{2} \left( 1 - \epsilon \frac{x(l-x)}{l^{2}} \right) \phi = 0, \hspace{3mm} \phi(0) = \phi(l) = 0.
\]</div>
<p>Here <span class="math notranslate nohighlight">\(k_{0}^{2} = \rho_{0} \omega^{2} l^{2} / c_{0}^{2}\)</span>. After rescaling, <span class="math notranslate nohighlight">\(x\)</span> with <span class="math notranslate nohighlight">\(l\)</span>, the equation can be written as</p>
<div class="math notranslate nohighlight">
\[
\phi'' + \lambda^{2}(1 - \epsilon x (1-x))\phi = 0, \hspace{3mm} \phi(0) = \phi(1) = 0,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda^{2} = k_{0}^{2}l^{2} = \omega^{2}l^{2}/c_{0}^{2}\)</span>.</p>
<p>Next, the problem is to find the solution at various values of <span class="math notranslate nohighlight">\(\epsilon\)</span>.</p>
<p>Note that if <span class="math notranslate nohighlight">\(\epsilon = 0\)</span>, then we have the analytical solution: <span class="math notranslate nohighlight">\(\lambda_{n} = n\pi\)</span> and <span class="math notranslate nohighlight">\(\phi_{n} = \sin{(\pi n x)}, n \in \mathbb{N}\)</span>.</p>
<p><strong>(a)</strong> Find the eigenvalues <span class="math notranslate nohighlight">\(\lambda^{2}\)</span> numerically using the second derivative approximation</p>
<div class="math notranslate nohighlight">
\[
\phi'' \approx (\phi_{i-1} - 2\phi_{i} + \phi_{i+1})/h^{2}
\]</div>
<p>with the grid points <span class="math notranslate nohighlight">\(x = x_{i} = ih, i=0, 1, 2, ..., n+1\)</span> and the grid size <span class="math notranslate nohighlight">\(h = l/(n+1)\)</span>. Take <span class="math notranslate nohighlight">\(n\)</span> sufficiently large so that the computed eigenvalues and eigenvectors are accurate. How do you choose that number?</p>
<p><strong>(b)</strong> Plot the eigenvectors that correspond to the lowest five eigenvalues at <span class="math notranslate nohighlight">\(\epsilon = 0.1\)</span> and on a separate plot show the first ten numerically found eigenvalues <span class="math notranslate nohighlight">\(\lambda\)</span>. How do they compare with those at <span class="math notranslate nohighlight">\(\epsilon = 0\)</span>?</p>
<p><strong>(c)</strong> How do the eigenvalues and eigenfunctions change when <span class="math notranslate nohighlight">\(\epsilon\)</span> increases? Plot <span class="math notranslate nohighlight">\(\lambda (\epsilon)\)</span>.</p>
<div class="section" id="id1">
<h3>Solution<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id2">
<h4>(a)<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>At first, we need to come up with the matrix form.</p>
<p>For this, let’s plug the approximation into the equation and rearrange the members:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\phi_{i-1} - 2\phi_{i} + \phi_{i+1} + \lambda^{2} h^{2}(1-\epsilon x(1-x))\phi_{i} = 0, \\
\hspace{3mm} \\
\phi_{i-1} - 2\phi_{i} + \phi_{i+1} = \lambda^{2} h^{2} \hat{\rho_{i}} \phi_{i} \\
\hspace{3mm} \\
A\phi = \lambda^{2} K\phi,
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{\rho_{i}} = (\epsilon x_{i}(1-x_{i}) - 1)\)</span>.</p>
<p>To move <span class="math notranslate nohighlight">\(K\)</span> to the left, we have to be sure that it is not singular. Since it is a diagonal matrix with elements <span class="math notranslate nohighlight">\(h^{2}\hat{\rho_{i}}\)</span>, all of it’s elemets must be non-zero. Knowing <span class="math notranslate nohighlight">\(h^{2}\)</span> is not zero, we get the condition of singularity:</p>
<div class="math notranslate nohighlight">
\[
\epsilon x_{i}(1-x_{i}) - 1 = 0,
\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[
x^{2}_{i} - x_{i} + \frac{1}{\epsilon} = 0, \hspace{3mm} \epsilon \neq 0.
\]</div>
<p>Solving this quadratic equation for <span class="math notranslate nohighlight">\(x_{i}\)</span>, we get:</p>
<div class="math notranslate nohighlight">
\[
x_{i_{1, 2}} = \frac{1}{2} \left( 1 \pm \sqrt{1 - \frac{4}{\epsilon}}\right).
\]</div>
<p>For <span class="math notranslate nohighlight">\(x_{i}\)</span> to have real roots, <span class="math notranslate nohighlight">\(\epsilon\)</span> must be <span class="math notranslate nohighlight">\(\geq 4\)</span>. As long as <span class="math notranslate nohighlight">\(\epsilon \leq 4\)</span>, the matrix <span class="math notranslate nohighlight">\(K\)</span> is non-singular and can be moved to the left:</p>
<div class="math notranslate nohighlight">
\[
K^{-1}A\phi = \lambda^{2} \phi.
\]</div>
<p><span class="math notranslate nohighlight">\(K\)</span> doesn’t depend on <span class="math notranslate nohighlight">\(\phi\)</span>, thus we can precalculate it and then transfer the inverted matrix <span class="math notranslate nohighlight">\(K^{-1}\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>At first, I want to see the general solution with any <span class="math notranslate nohighlight">\(\epsilon\)</span> and abstract <span class="math notranslate nohighlight">\(h\)</span>. By the powers of <em>SymPy</em> I will carry <span class="math notranslate nohighlight">\(\epsilon\)</span> in the calculations. Due to the computation complexity of eigen<strong>values</strong> (let alone eigen<strong>vectors</strong>), the grid for this step will be chosen extremely sparse Actually, I was not able to get any solution for grids larger that 2 (!) points. Let it be 2 points then.</p>
<p>This is just for pure educational purposes, it serves no practical reason.</p>
</div>
<p>For matrix <span class="math notranslate nohighlight">\(K\)</span>, we can write it’s diagonal element in terms of our grid as follows:</p>
<div class="math notranslate nohighlight">
\[
K^{i}_{i} = h^{2}(\epsilon ih(1-ih)-1)
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span><span class="p">,</span> <span class="n">eps</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x0, epsilon, h&#39;</span><span class="p">)</span>

<span class="n">step</span> <span class="o">=</span> <span class="mf">0.5</span>


<span class="k">def</span> <span class="nf">create_grid</span><span class="p">(</span><span class="n">step</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">m</span>

<span class="n">X</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">create_grid</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>


<span class="c1">#computing the matrix K along the grid</span>
<span class="k">def</span> <span class="nf">matrix_K</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">vec</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">eps</span><span class="o">*</span><span class="n">i</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">h</span><span class="p">))</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">K</span>

<span class="n">K</span> <span class="o">=</span> <span class="n">matrix_K</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>


<span class="c1">#building the inverse matrix K^-1</span>
<span class="n">K_inv</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>


<span class="c1">#Building the matrix A</span>
<span class="k">def</span> <span class="nf">matrix_A</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">)])</span>
    <span class="n">ud</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">))</span>
    <span class="n">ld</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">))</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">ud</span> <span class="o">+</span> <span class="n">ld</span>
    <span class="k">return</span> <span class="n">A</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">matrix_A</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>


<span class="c1">#Building the final matrix B: B{phi} = lambda^2 {phi}</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">K_inv</span><span class="o">*</span><span class="n">A</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s have a look at the matrix <span class="math notranslate nohighlight">\(B\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}\frac{2}{h^{2}} &amp; - \frac{1}{h^{2}}\\- \frac{1}{\epsilon h^{4} - \epsilon h^{3} + h^{2}} &amp; \frac{2}{\epsilon h^{4} - \epsilon h^{3} + h^{2}}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>Now we can find the eigenvalues with respect to <span class="math notranslate nohighlight">\(\epsilon\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vals</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">eigenvals</span><span class="p">()</span>
<span class="n">vals_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">vals</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">vals_vec</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">vals_list</span><span class="p">)</span>
<span class="n">vals_vec</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="n">vals_vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}\frac{\epsilon h^{2} - \epsilon h - \sqrt{\epsilon^{2} h^{4} - 2 \epsilon^{2} h^{3} + \epsilon^{2} h^{2} + \epsilon h^{2} - \epsilon h + 1} + 2}{h^{2} \left(\epsilon h^{2} - \epsilon h + 1\right)}\\\frac{\epsilon h^{2} - \epsilon h + \sqrt{\epsilon^{2} h^{4} - 2 \epsilon^{2} h^{3} + \epsilon^{2} h^{2} + \epsilon h^{2} - \epsilon h + 1} + 2}{h^{2} \left(\epsilon h^{2} - \epsilon h + 1\right)}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At this point, there is no point (sorry) for solving the system symbolically. It just takes a large (and unknown) amount of time.</p>
</div>
</div>
<div class="section" id="id3">
<h4>(b)<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>Now let us increase the grid density and substitute the <span class="math notranslate nohighlight">\(\epsilon\)</span> and <span class="math notranslate nohighlight">\(h\)</span> with real values. We’ll take <span class="math notranslate nohighlight">\(\epsilon = 0.1\)</span> to correspond with the next point of the problem. The grid density was taken large enough to be accurate, but low enough to not brick my laptop for hours.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As for more meaningful reasoning for the grid density, we shall account for the approximation method of the second derivative. In this method, we assume that between the points <span class="math notranslate nohighlight">\(x_{i-1}\)</span> and <span class="math notranslate nohighlight">\(x_{i}\)</span>, as well as <span class="math notranslate nohighlight">\(x_{i}\)</span> and <span class="math notranslate nohighlight">\(x_{i+1}\)</span> the function doesn’t change too much. By too much we understand that between two points it could, for example, have a peak with it’s derivative changing the sign. Concider, for example, a function <span class="math notranslate nohighlight">\(\cos{\omega x}\)</span> with <span class="math notranslate nohighlight">\(\omega\)</span> equal to the number of the points on the grid (<span class="math notranslate nohighlight">\(\omega = 1000\)</span> for simplicity). There are 1000 points where <span class="math notranslate nohighlight">\(\sin(1000x)\)</span> intersects the <span class="math notranslate nohighlight">\(X\)</span> axis, with its value being <span class="math notranslate nohighlight">\(0\)</span> and derivative being <span class="math notranslate nohighlight">\(\pm 1000\cos{(1000x)}\)</span>. If the points of the grid are distributed uniformly between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(pi\)</span>, they very well lay exatly on top of those points of the intersection. That means, when we start numerical calculation, where every next point depends on the previous, our solution will diverge from the real solution very quickly.
As a conclusion, the grid density should overcome the frequency of the largest-amplitude oscillations. The more frequent oscillations will be lost.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">step</span> <span class="o">=</span> <span class="mf">0.005</span>

<span class="n">X</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">create_grid</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>

<span class="n">K</span> <span class="o">=</span> <span class="n">matrix_K</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="n">K_inv</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">matrix_A</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="n">B</span> <span class="o">=</span> <span class="n">K_inv</span><span class="o">*</span><span class="n">A</span>

<span class="c1">#substitution dictionary:</span>

<span class="n">sub</span> <span class="o">=</span> <span class="p">{</span><span class="n">h</span><span class="p">:</span> <span class="n">step</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}</span>

<span class="n">B_sub</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
<span class="n">B_sub</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}80000.0 &amp; -40000.0 &amp; 0\\-40019.9099051778 &amp; 80039.8198103556 &amp; -40019.9099051778\\0 &amp; -40039.6392428504 &amp; 80079.2784857008\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">scp</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">sparse</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">linalg</span>

<span class="n">B_sparse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">B_sub</span><span class="p">)</span>
<span class="n">B_sparse</span> <span class="o">=</span> <span class="n">B_sparse</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">vals</span><span class="p">,</span> <span class="n">vecs</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">eigs</span><span class="p">(</span><span class="n">B_sparse</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}9.98816227171941\\39.7938944175406\\89.4633831983829\\158.983843331693\\248.33821812498\\357.504660920439\\486.456496708027\\635.162220479623\\803.585502722614\\991.68519754949\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>Here are the 10 lowest eigenvalues <span class="math notranslate nohighlight">\(\lambda ^{2}\)</span>. Let’s plot the eigenfunctions and eigenvectors on two separate plots and compare them with <span class="math notranslate nohighlight">\(\epsilon = 0\)</span> case:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vecs</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Eigenfunctions for $\epsilon = 0.1$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Scaled $x$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\phi(x)$&#39;</span><span class="p">)</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vals</span><span class="p">)),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Eigenvalues&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$i$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\lambda_i$&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ProblemSet3_18_0.svg" src="../_images/ProblemSet3_18_0.svg" /></div>
</div>
<p>At this point with <span class="math notranslate nohighlight">\(\epsilon\)</span> being a small number we see almost no difference with pure <span class="math notranslate nohighlight">\(\sin{}\)</span> functions. Let us plug <span class="math notranslate nohighlight">\(\epsilon = 3\)</span> and see what happens:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">step</span> <span class="o">=</span> <span class="mf">0.005</span>

<span class="n">X2</span><span class="p">,</span> <span class="n">m2</span> <span class="o">=</span> <span class="n">create_grid</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>

<span class="n">K2</span> <span class="o">=</span> <span class="n">matrix_K</span><span class="p">(</span><span class="n">m2</span><span class="p">)</span>

<span class="n">K2_inv</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>

<span class="n">A2</span> <span class="o">=</span> <span class="n">matrix_A</span><span class="p">(</span><span class="n">m2</span><span class="p">)</span>

<span class="n">B2</span> <span class="o">=</span> <span class="n">K_inv</span><span class="o">*</span><span class="n">A</span>

<span class="c1">#substitution dictionary:</span>

<span class="n">sub2</span> <span class="o">=</span> <span class="p">{</span><span class="n">h</span><span class="p">:</span> <span class="n">step</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

<span class="n">B2_sub</span> <span class="o">=</span> <span class="n">B2</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">sub2</span><span class="p">)</span>
<span class="c1">##B2_sub[0:3, 0:3]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B2_sparse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">B2_sub</span><span class="p">)</span>
<span class="n">B2_sparse</span> <span class="o">=</span> <span class="n">B2_sparse</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">vals2</span><span class="p">,</span> <span class="n">vecs2</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">eigs</span><span class="p">(</span><span class="n">B2_sparse</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1">##sp.Matrix(vals2)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig2</span><span class="p">,</span> <span class="p">(</span><span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vecs2</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]))</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Eigenfunctions for $\epsilon = 3$&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Scaled $x$&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\phi(x)$&#39;</span><span class="p">)</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vals2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>

<span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vals2</span><span class="p">)),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Eigenvalues&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$i$&#39;</span><span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\lambda_i$&#39;</span><span class="p">)</span>
<span class="n">fig2</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ProblemSet3_22_0.svg" src="../_images/ProblemSet3_22_0.svg" /></div>
</div>
<p>We can see a certain amount of envelope function presense, as well as phase shifting.</p>
</div>
<div class="section" id="id4">
<h4>(c)<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>To do this task, we have to create a grid of <span class="math notranslate nohighlight">\(\epsilon\)</span> values and solve for every <span class="math notranslate nohighlight">\(\epsilon\)</span> in the grid. I will reduce the density of the grid to reduce the computation time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">step3</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="n">X3</span><span class="p">,</span> <span class="n">m3</span> <span class="o">=</span> <span class="n">create_grid</span><span class="p">(</span><span class="n">step3</span><span class="p">)</span>

<span class="c1">#print(&#39;Created Grid&#39;)</span>

<span class="n">K3</span> <span class="o">=</span> <span class="n">matrix_K</span><span class="p">(</span><span class="n">m3</span><span class="p">)</span>

<span class="n">K3_inv</span> <span class="o">=</span> <span class="n">K3</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>

<span class="c1">#print(&#39;Calculated K3_inv&#39;)</span>

<span class="n">A3</span> <span class="o">=</span> <span class="n">matrix_A</span><span class="p">(</span><span class="n">m3</span><span class="p">)</span>

<span class="c1">#print(&#39;Calculated A3&#39;)</span>

<span class="n">B3</span> <span class="o">=</span> <span class="n">K3_inv</span><span class="o">*</span><span class="n">A3</span>

<span class="c1">#print(&#39;Calculated B3&#39;)</span>

<span class="c1">#substitution dictionaries:</span>
<span class="n">max_eps</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">eps_points</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">epss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">max_eps</span><span class="o">/</span><span class="n">eps_points</span><span class="p">)</span>
<span class="n">substs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">eps_points</span><span class="p">):</span>
    <span class="n">substs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">substs</span><span class="p">,</span> <span class="p">{</span><span class="n">h</span><span class="p">:</span> <span class="n">step3</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="n">epss</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>

<span class="c1">#print(&#39;Finished creating subs dictionaries&#39;)</span>

<span class="n">B3s</span> <span class="o">=</span> <span class="p">[</span><span class="n">B3</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">substs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">eps_points</span><span class="p">)]</span>

<span class="n">B3s_sparse</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">B3s</span><span class="p">]</span>

<span class="c1">#print(&#39;Created numpy matrices&#39;)</span>

<span class="n">Vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">((</span><span class="n">eps_points</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">Vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="n">m3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">eps_points</span><span class="p">):</span>
    <span class="c1">#print(&#39;Calculating {}th eigenvalues...&#39;.format(i))</span>
    <span class="n">va</span><span class="p">,</span> <span class="n">ve</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">eigs</span><span class="p">(</span><span class="n">B3s_sparse</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">Vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">va</span>
    <span class="n">Vecs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ve</span>
    <span class="c1">#print(&#39;Calculated {}th eigenvalues&#39;.format(i))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Vecss</span> <span class="o">=</span> <span class="p">[</span><span class="n">Vecs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Vecs</span><span class="p">))]</span>
<span class="n">Valss</span> <span class="o">=</span> <span class="n">Vals</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

<span class="n">figg</span><span class="p">,</span> <span class="p">(</span><span class="n">axx1</span><span class="p">,</span> <span class="n">axx2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">axx2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epss</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Valss</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">eps_points</span><span class="p">):</span>
        <span class="n">axx1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X3</span><span class="p">,</span> <span class="n">Vecss</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

<span class="n">axx1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Eigenfunctions (lol)&#39;</span><span class="p">)</span>
<span class="n">axx1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Scaled x&#39;</span><span class="p">)</span>
<span class="n">axx1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\phi_</span><span class="si">{ij}</span><span class="s1">(x)$&#39;</span><span class="p">)</span>

<span class="n">axx2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Eigenvalues&#39;</span><span class="p">)</span>
<span class="n">axx2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\epsilon$&#39;</span><span class="p">)</span>
<span class="n">axx2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\lambda$&#39;</span><span class="p">)</span>
<span class="n">legends</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$\lambda_{{</span><span class="si">{}</span><span class="s1">}}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">axx2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legends</span><span class="p">)</span>

<span class="n">figg</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ProblemSet3_26_0.svg" src="../_images/ProblemSet3_26_0.svg" /></div>
</div>
<p>Jokes aside, we can follow the transformation of some eigenfunction related to a certain eigenvalue, for example, <span class="math notranslate nohighlight">\(\lambda_{5}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Vecsss</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">Vecss</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">eps_points</span><span class="p">):</span>
    <span class="n">Vecsss</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vecss</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">eps_points</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X3</span><span class="p">,</span> <span class="n">Vecsss</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Scaled x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$\phi_</span><span class="si">{5}</span><span class="s1">^{(i)}$&#39;</span><span class="p">)</span>

<span class="n">legends</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$\epsilon = </span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epss</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">eps_points</span><span class="p">)]</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legends</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ProblemSet3_28_0.svg" src="../_images/ProblemSet3_28_0.svg" /></div>
</div>
<p>With increasing <span class="math notranslate nohighlight">\(\epsilon\)</span> we observe non-lenarity in the phase of the standing waves (eigenfunctions) and progressing “enveloping”. Let’s explore what happens, when we reach <span class="math notranslate nohighlight">\(\epsilon = 4\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">step4</span> <span class="o">=</span> <span class="mf">0.005</span>

<span class="n">X4</span><span class="p">,</span> <span class="n">m4</span> <span class="o">=</span> <span class="n">create_grid</span><span class="p">(</span><span class="n">step4</span><span class="p">)</span>

<span class="n">K4</span> <span class="o">=</span> <span class="n">matrix_K</span><span class="p">(</span><span class="n">m4</span><span class="p">)</span>

<span class="n">K4_inv</span> <span class="o">=</span> <span class="n">K4</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>

<span class="n">A4</span> <span class="o">=</span> <span class="n">matrix_A</span><span class="p">(</span><span class="n">m4</span><span class="p">)</span>

<span class="n">B4</span> <span class="o">=</span> <span class="n">K4_inv</span><span class="o">*</span><span class="n">A4</span>

<span class="c1">#substitution dictionaries:</span>
<span class="n">epss2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.8</span><span class="p">,</span> <span class="mf">3.9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">substs2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">epss2</span><span class="p">)):</span>
    <span class="n">substs2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">substs2</span><span class="p">,</span> <span class="p">{</span><span class="n">h</span><span class="p">:</span> <span class="n">step4</span><span class="p">,</span> <span class="n">eps</span><span class="p">:</span> <span class="n">epss2</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>

<span class="n">B4s</span> <span class="o">=</span> <span class="p">[</span><span class="n">B4</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">substs2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">substs2</span><span class="p">))]</span>

<span class="n">B4s_sparse</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">B4s</span><span class="p">]</span>

<span class="n">Vals2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">epss2</span><span class="p">),</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">Vecs2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="n">m4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">epss2</span><span class="p">)):</span>
    <span class="n">va2</span><span class="p">,</span> <span class="n">ve2</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">eigs</span><span class="p">(</span><span class="n">B4s_sparse</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">Vals2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">va2</span>
    <span class="n">Vecs2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ve2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Vecss2</span> <span class="o">=</span> <span class="p">[</span><span class="n">Vecs2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Vecs2</span><span class="p">))]</span>
<span class="n">Vecss2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vecss2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*-</span><span class="mi">1</span>
<span class="n">Vecss2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vecss2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*-</span><span class="mi">1</span>
<span class="n">Vecss2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vecss2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*-</span><span class="mi">1</span>
<span class="n">Valss2</span> <span class="o">=</span> <span class="n">Vals2</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

<span class="n">figg2</span><span class="p">,</span> <span class="p">(</span><span class="n">axx12</span><span class="p">,</span> <span class="n">axx22</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">axx22</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epss2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Valss2</span><span class="p">[</span><span class="n">i</span><span class="p">]))),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">epss2</span><span class="p">)):</span>
    <span class="n">axx12</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X4</span><span class="p">,</span> <span class="n">Vecss2</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">4</span><span class="p">])</span>

<span class="n">axx12</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Eigenfunction $\lambda_5 \Rightarrow \phi(x)$&#39;</span><span class="p">)</span>
<span class="n">axx12</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Scaled x&#39;</span><span class="p">)</span>
<span class="n">axx12</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\phi(x)$&#39;</span><span class="p">)</span>

<span class="n">legends12</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$\epsilon = </span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epss2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">epss2</span><span class="p">))]</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">axx12</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legends12</span><span class="p">)</span>

<span class="n">axx22</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Eigenvalues&#39;</span><span class="p">)</span>
<span class="n">axx22</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\epsilon$&#39;</span><span class="p">)</span>
<span class="n">axx22</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\lambda$&#39;</span><span class="p">)</span>
<span class="n">legends2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;$\lambda_{{</span><span class="si">{}</span><span class="s1">}}$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">axx22</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legends2</span><span class="p">)</span>

<span class="n">figg2</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ProblemSet3_31_0.svg" src="../_images/ProblemSet3_31_0.svg" /></div>
</div>
<p>Well, it can be seen very clearly on the graph, but let’s analyze.</p>
<p>Firstly, let’s plug <span class="math notranslate nohighlight">\(\epsilon = 4\)</span> into the roots equation for <span class="math notranslate nohighlight">\(\hat\rho = 0\)</span> (also applicable to <span class="math notranslate nohighlight">\(\rho\)</span>):</p>
<div class="math notranslate nohighlight">
\[
x_{1, 2} = \frac{1}{2} \left( 1 \pm \sqrt{1 - \frac{4}{4}}\right) = \frac{1}{2}
\]</div>
<p>As soon as <span class="math notranslate nohighlight">\(\epsilon\)</span> reaches <span class="math notranslate nohighlight">\(4\)</span>, a non-imaginary solution for this equation appears in terms of <span class="math notranslate nohighlight">\(x\)</span>, meaning that at the point <span class="math notranslate nohighlight">\(x = \frac{1}{2}\)</span> the eigenvalue problem will look like this:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\phi'' + \lambda^2 \rho(x)\phi = \phi'' + 0 = 0,\\
\hspace{3mm}\\
\phi(x) = C_{1}x + C_{2}, \hspace{3mm} x=\frac{1}{2}.
\end{split}\]</div>
<p>In the neighborhood of the point <span class="math notranslate nohighlight">\(x = \frac{1}{2}\)</span> the solution <span class="math notranslate nohighlight">\(\phi(x)\)</span> will be almost linear due to the negligibility of the term <span class="math notranslate nohighlight">\(\rho(x)\)</span>.</p>
<p>As long as <span class="math notranslate nohighlight">\(x\)</span> crosses the root point, the term <span class="math notranslate nohighlight">\(\rho\)</span> changes its sign, meaning that the problem transforms:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\phi'' + C^2 \phi = 0, \hspace{3mm} \rho &gt; 0, \\
\phi'' - C^2 \phi = 0, \hspace{3mm} \rho &lt; 0,
\end{split}\]</div>
<p>And the solution <span class="math notranslate nohighlight">\(\phi\)</span> transfers from the harmonic form to the exponential form.</p>
<p>As long as <span class="math notranslate nohighlight">\(\epsilon\)</span> continues to grow, we will observe two symmetrically diverging (from <span class="math notranslate nohighlight">\(x = \frac{1}{2}\)</span>) points, where <span class="math notranslate nohighlight">\(\rho(x) = 0\)</span> and thus <span class="math notranslate nohighlight">\(\phi\)</span> acts almost linearly (and performs the transition from one form to another).</p>
</div>
</div>
</div>
<div class="section" id="problem-3">
<h2>Problem 3<a class="headerlink" href="#problem-3" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(A = \begin{bmatrix}5 &amp; -3 \\ 0 &amp; 4 \end{bmatrix}\)</span>.</p>
<p><strong>(a)</strong> Find the SVD of A and illustrate on paper how <span class="math notranslate nohighlight">\(A = U\Sigma V^T\)</span> transforms a vector <span class="math notranslate nohighlight">\(x\)</span> into <span class="math notranslate nohighlight">\(Ax\)</span> by a sequence of three transformations.</p>
<p><strong>(b)</strong> Compare the result from <strong>(a)</strong> with how <span class="math notranslate nohighlight">\(A = S\Lambda S^-1\)</span> transforms <span class="math notranslate nohighlight">\(x\)</span> into <span class="math notranslate nohighlight">\(Ax\)</span>.</p>
<div class="section" id="id5">
<h3>Solution<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>The SVD decomposition is as follows:</p>
<div class="figure align-default" id="ps3p1p1">
<a class="reference internal image-reference" href="../_images/Problem_3_1.jpg"><img alt="../_images/Problem_3_1.jpg" src="../_images/Problem_3_1.jpg" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 3 </span><span class="caption-text">Page 1</span><a class="headerlink" href="#ps3p1p1" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="ps3p1p2">
<a class="reference internal image-reference" href="../_images/Problem_3_2.jpg"><img alt="../_images/Problem_3_2.jpg" src="../_images/Problem_3_2.jpg" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 4 </span><span class="caption-text">Page 2</span><a class="headerlink" href="#ps3p1p2" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id6">
<a class="reference internal image-reference" href="../_images/Problem_3_3.jpg"><img alt="../_images/Problem_3_3.jpg" src="../_images/Problem_3_3.jpg" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 5 </span><span class="caption-text">Page 3</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id7">
<a class="reference internal image-reference" href="../_images/Problem_3_4.jpg"><img alt="../_images/Problem_3_4.jpg" src="../_images/Problem_3_4.jpg" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 6 </span><span class="caption-text">Page 4</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<p>To compare with spectral decomposition, we need to understand what each does.</p>
<p>SVD decomposes the complex linear transformation into a consequent set of rotations and stretch, while spectral decomposition firstly presents <span class="math notranslate nohighlight">\(x\)</span> in the basis of <span class="math notranslate nohighlight">\(A's\)</span> eigenvalues, stretches there by its eigenvalues, then returns the representation of <span class="math notranslate nohighlight">\(x\)</span> to the initial basis:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
x = ah_1 + bh_2; \\
\hspace{3mm}\\
S^{-1}x = S^{-1}ah_1 + S^{-1}bh_2 = a\begin{bmatrix}1\\0\end{bmatrix} + b\begin{bmatrix}0\\1\end{bmatrix};\\
\hspace{3mm}\\
AS^{-1}x = a\begin{bmatrix}\lambda_1\\0\end{bmatrix} + b\begin{bmatrix}0\\\lambda_2\end{bmatrix};\\
\hspace{3mm}\\
SAS^{-1}x = a\begin{bmatrix}h_1 &amp; h_2\end{bmatrix}\begin{bmatrix}\lambda_1 \\ 0\end{bmatrix} + \begin{bmatrix}h_1 &amp; h_2\end{bmatrix}\begin{bmatrix}0 \\ \lambda_2\end{bmatrix} =\\
\hspace{3mm}\\
=a\lambda_1 h_1 + b\lambda_2 h_2.
\end{split}\]</div>
</div>
</div>
<div class="section" id="problem-4">
<h2>Problem 4<a class="headerlink" href="#problem-4" title="Permalink to this headline">¶</a></h2>
<p>Given column vectors <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>, find the SVD of:</p>
<p><strong>(a)</strong> <span class="math notranslate nohighlight">\(A = ab^T\)</span>,
<strong>(b)</strong> <span class="math notranslate nohighlight">\(B = ab^T + ba^T\)</span> when <span class="math notranslate nohighlight">\(a^Tb = 0\)</span>.</p>
<div class="section" id="id8">
<h3>Solution<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Much simplier solution at the end of this section</p>
</div>
<p>Let’s analyze the expression <span class="math notranslate nohighlight">\(ab^T\)</span>. Firstly, it is an <span class="math notranslate nohighlight">\(m \times n\)</span> matrix, with vector <span class="math notranslate nohighlight">\(a\)</span> being <span class="math notranslate nohighlight">\(1 \times m\)</span> and vector <span class="math notranslate nohighlight">\(b\)</span> being <span class="math notranslate nohighlight">\(1 \times n\)</span>. Its rank is 1, which can be seen below:</p>
<div class="math notranslate nohighlight">
\[
ab^T = \Big[ab_1, ab_2, ..., ab_n\Big],
\]</div>
<p>as it is a combination of columns of <span class="math notranslate nohighlight">\(a\)</span> multiplied by <span class="math notranslate nohighlight">\(b_i\)</span>, thus, every column is linearly dependent. It follows that there will be only one non-zero eigenvalue and one corresponding eigenvector. Others can be chosen orthogonally to it.</p>
<p>Let’s start the SVD procedure:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A^TA = V\Sigma^T\Sigma V^T,\\
\hspace{3mm}\\
ba^Tab^T = V \Sigma^T \Sigma V^T.
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(a^Ta\)</span> is a squared norm of vector <span class="math notranslate nohighlight">\(a\)</span>, i.e. a scalar. Moving it to the right:</p>
<div class="math notranslate nohighlight">
\[
|a|^2bb^T = V \Sigma^T \Sigma V^T.
\]</div>
<p>Following the process, we concider matrix <span class="math notranslate nohighlight">\(\Sigma\)</span> consisting of the square of eigenvalues of the matrix <span class="math notranslate nohighlight">\(A^T A\)</span>, and <span class="math notranslate nohighlight">\(V\)</span> consisting of its corresponding eigenvectors. Finding the eigenvectors:</p>
<div class="math notranslate nohighlight">
\[
|a|^2 bb^T h = \lambda h.
\]</div>
<p>But <span class="math notranslate nohighlight">\(b^T h\)</span> is another scalar, name it <span class="math notranslate nohighlight">\(\kappa\)</span>. Then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
|a|^2 \kappa b = \lambda h,\\
\hspace{3mm}\\
h = |a|^2 \frac{\kappa}{\lambda}b.
\end{split}\]</div>
<p>The eigenvector <span class="math notranslate nohighlight">\(h\)</span> is collinear with vector <span class="math notranslate nohighlight">\(b\)</span>. Its eigenvalue <span class="math notranslate nohighlight">\(\lambda\)</span> is the only non-zero eigenvalue, thus, matrix <span class="math notranslate nohighlight">\(\Sigma\)</span> will be a zero matrix except the first diagonal element <span class="math notranslate nohighlight">\(\sigma^1_1 = \sqrt{\lambda}\)</span>. We want the vector <span class="math notranslate nohighlight">\(h\)</span> normalized, thus, we divide it by its length:</p>
<div class="math notranslate nohighlight">
\[
h := \frac{h}{|h|} = \frac{cb}{c|b|} = \frac{b}{|b|} = \begin{bmatrix}e_1 &amp; ...&amp;  e_n\end{bmatrix}^T, \hspace{3mm} \sum\limits_{i = 1}^{n}{e_i^2} = 1,
\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[
e_i = \frac{b_i}{|b|}.
\]</div>
<p>Then we may plug the vector <span class="math notranslate nohighlight">\(h\)</span> into its definition and receive:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\frac{b}{|b|} = |a|^2 \frac{b^T \frac{b}{|b|}}{\lambda}b,\\
\hspace{3mm}\\
b = \frac{|a|^2|b|^2}{\lambda}b,
\end{split}\]</div>
<p>from here we derive <span class="math notranslate nohighlight">\(\lambda = |a|^2|b|^2\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the sake of readability I will carry the symbol <span class="math notranslate nohighlight">\(\lambda\)</span> as is.</p>
</div>
<p>So, our eigenvector <span class="math notranslate nohighlight">\(h\)</span> is the unit vector in the direction of vector <span class="math notranslate nohighlight">\(b\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This following step is completely irrelevant, but I decided not to remove it due to the amount of time i spent on it.</p>
</div>
<p>To complete the matrix <span class="math notranslate nohighlight">\(V\)</span>, we need to find <span class="math notranslate nohighlight">\(n-1\)</span> more orthogonal vectors, which all will be eigenvectors with <span class="math notranslate nohighlight">\(\lambda_i = 0\)</span>. To do this, we can follow this logic. Let <span class="math notranslate nohighlight">\(c\)</span> be our hypothetical eigenvector. It has to satisfy <span class="math notranslate nohighlight">\(h^Tc = 0\)</span>:</p>
<div class="math notranslate nohighlight">
\[
h_1c_1 + h_2c_2 + ... + h_nc_n = 0.
\]</div>
<p>Suppose we have <span class="math notranslate nohighlight">\(k\)</span> non-zero components of vector <span class="math notranslate nohighlight">\(h\)</span>. Then we straightforwardly have <span class="math notranslate nohighlight">\(n-k\)</span> orthogonal eigenvectors <span class="math notranslate nohighlight">\(c_i\)</span>:</p>
<div class="math notranslate nohighlight">
\[
c^{(i)} = \begin{bmatrix}0 &amp; ... &amp; 0 &amp; 1 &amp; 0 &amp; ...\end{bmatrix}^T
\]</div>
<p>with <span class="math notranslate nohighlight">\(c^{(i)}_l = 1\)</span> at such <span class="math notranslate nohighlight">\(l\)</span> that <span class="math notranslate nohighlight">\(h_l = 0\)</span>. Another <span class="math notranslate nohighlight">\(k-1\)</span> vectors <span class="math notranslate nohighlight">\(f^{(i)}\)</span> orthogonal to <span class="math notranslate nohighlight">\(h\)</span> and to each other can be acquired through Gramm-Schmidt orthogonalization process.</p>
<p>Consider a basis in the space of dimension <span class="math notranslate nohighlight">\(k\)</span> complement to the space that is build on top of our vectors <span class="math notranslate nohighlight">\(c^{(i)}\)</span>. It can be build from vector <span class="math notranslate nohighlight">\(h\)</span> and <span class="math notranslate nohighlight">\(k-1\)</span> non-zero components of <span class="math notranslate nohighlight">\(h\)</span> with each vector being only one component:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
r^{(i)}_j =
\begin{cases}
0, &amp; i \neq j\\
h_j, &amp; i = j
\end{cases}
\end{equation}
\end{split}\]</div>
<p>The projection operator <span class="math notranslate nohighlight">\(proj_{r}f\)</span> is defined as follows:</p>
<div class="math notranslate nohighlight">
\[
proj_{r}f = \frac{f^Tr}{r^Tr}r.
\]</div>
<p>Then we get:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
f'^{(1)} = \frac{h}{|h|}, \hspace{3mm} f^{(1)} = \frac{f'^{(1)}}{|f'^{(1)}|}\\
\hspace{3mm}\\
f'^{(2)} = r^{(2)} - proj_{r^{(2)}}f^{(1)}, \hspace{3mm} f^{(2)} = \frac{f'^{(2)}}{|f'^{(2)}|}
\end{align*}\\
...
\end{split}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Actually we have <span class="math notranslate nohighlight">\(k+1\)</span> linearly independend vectors: vector <span class="math notranslate nohighlight">\(h\)</span> and <span class="math notranslate nohighlight">\(k\)</span> vectors <span class="math notranslate nohighlight">\(r^{(i)}\)</span>, so we will stop at <span class="math notranslate nohighlight">\(i = k-1\)</span>. Acquiring vector <span class="math notranslate nohighlight">\(r^{(k)}\)</span> will make the system linearly dependent, because vectors <span class="math notranslate nohighlight">\(r^{(i)}\)</span> are in fact a decomposition of <span class="math notranslate nohighlight">\(h\)</span> into projections on the basis vectors of the <span class="math notranslate nohighlight">\(k\)</span> dimension space where all <span class="math notranslate nohighlight">\(h_i\)</span> components are non-zero.</p>
</div>
<p>Finally we have a full system of orthonormal vectors <span class="math notranslate nohighlight">\(c^{(i)}\)</span> and <span class="math notranslate nohighlight">\(f^{(j)}\)</span>, with <span class="math notranslate nohighlight">\(i = 1,...,n-k\)</span> and <span class="math notranslate nohighlight">\(j = 1, ..., k-1\)</span> and vector <span class="math notranslate nohighlight">\(h\)</span>.</p>
<p>Then our matrix <span class="math notranslate nohighlight">\(V\)</span> will look like this:</p>
<div class="math notranslate nohighlight">
\[
V =
\begin{bmatrix} h &amp; c^{(1)} &amp; ... &amp; c^{(n-k)} &amp; f^{(1)} &amp; ... &amp; f^{(k-1)}
\end{bmatrix},
\]</div>
<p>and matrix <span class="math notranslate nohighlight">\(\Sigma\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\Sigma =
\begin{bmatrix}
\sqrt{\lambda} &amp; 0 &amp; \cdots \\
0 &amp; 0 &amp; \cdots \\
\vdots &amp; \vdots &amp; \ddots
\end{bmatrix}
\end{split}\]</div>
<p>Finishing the SV decomposition, we need to find the matrix <span class="math notranslate nohighlight">\(U\)</span>. For this, we write</p>
<div class="math notranslate nohighlight">
\[
AV = U\Sigma,
\]</div>
<p>and thus</p>
<div class="math notranslate nohighlight">
\[\begin{split}
U = AV\Sigma^{-1} = ab^T 
\begin{bmatrix} h &amp; c^{(1)} &amp; ... &amp; c^{(n-k)} &amp; f^{(1)} &amp; ... &amp; f^{(k-1)}
\end{bmatrix}
\begin{bmatrix}
\frac{1}{\sqrt{\lambda}} &amp; 0 &amp; \cdots \\
0 &amp; 0 &amp; \cdots \\
\vdots &amp; \vdots &amp; \ddots
\end{bmatrix}
 = \\
\hspace{3mm} \\
= ab^T 
\begin{bmatrix}
\frac{1}{\sqrt{\lambda}}h &amp; 0 &amp; \cdots
\end{bmatrix} = 
\frac{a}{|a||b|}
\begin{bmatrix}
|b| &amp; 0 &amp; \cdots
\end{bmatrix} = 
\begin{bmatrix}
\frac{a}{|a|} &amp; 0 &amp; \cdots
\end{bmatrix}
\end{split}\]</div>
<p>We see that <span class="math notranslate nohighlight">\(U\)</span> is a matrix with first column vector of all ones. It is easy to check that <span class="math notranslate nohighlight">\(U\)</span> is orthogonal.</p>
<p>As we previously found, vector <span class="math notranslate nohighlight">\(h\)</span> is a unit vector in the direction of <span class="math notranslate nohighlight">\(b\)</span>, thus <span class="math notranslate nohighlight">\(b^Th = |b|\)</span>.</p>
<p>Let’s perform a check:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = U\Sigma V^T = 
\begin{bmatrix}
\vdots &amp; \vdots &amp; \cdots\\
1 &amp; 0 &amp; \cdots\\
\vdots &amp; \vdots &amp; \cdots
\end{bmatrix}
\begin{bmatrix}
\sqrt{\lambda} &amp; 0 &amp; \cdots \\
0 &amp; 0 &amp; \cdots \\
\vdots &amp; \vdots &amp; \ddots
\end{bmatrix}
\begin{bmatrix}
\cdots &amp; h &amp; \cdots\\
\cdots &amp; c^{(1)} &amp; \cdots\\
\vdots &amp; \vdots &amp; \vdots
\end{bmatrix} = 
\begin{bmatrix}
\vdots &amp; \vdots &amp; \cdots\\
a &amp; 0 &amp; \cdots\\
\vdots &amp; \vdots &amp; \cdots
\end{bmatrix}
\begin{bmatrix}
\cdots &amp; b &amp; \cdots\\
\cdots &amp; 0 &amp; \cdots\\
\vdots &amp; \vdots &amp; \vdots
\end{bmatrix} =
ab^T.
\end{split}\]</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Pheeew</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is a simpler solution to this problem.</p>
<p>SVD is:</p>
<div class="math notranslate nohighlight">
\[
A = U\Sigma V^T
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
ab^T = \frac{a}{|a|}|a||b|\frac{b^T}{|b|}.
\]</div>
<p>As soon as we write down the definition of singular value decomposition, we see that <span class="math notranslate nohighlight">\(u\)</span> is a unit vector collinear to <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(v\)</span> is a unit vector collinear to <span class="math notranslate nohighlight">\(b\)</span>. Then plugging it back into the definition we receive:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
ab^T\alpha a = \sigma \alpha a;\\
b^Ta = \sigma \hspace{3mm} = |a||b|
\end{split}\]</div>
<p>And the SVD is complete.</p>
</div>
<p><strong>(b)</strong></p>
<p>It is obvious that <span class="math notranslate nohighlight">\(rg(A)\)</span> is <span class="math notranslate nohighlight">\(2\)</span>, since it is a sum of two rank-1 matrices with mutually linearly independent column vectors.</p>
<p>Let us utilize the definition of the SVD:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A u = \sigma v\\
A^* v = \sigma u
\end{split}\]</div>
<p>As we can easily see, <span class="math notranslate nohighlight">\(A^{*} = A^T = A\)</span>, thus</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Av = \sigma u,\\
Au = \sigma v
\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A^2v = \sigma^2 v,\\
A^2u = \sigma^2 u
\end{split}\]</div>
<p>Let’s find <span class="math notranslate nohighlight">\(A^2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A^2 = (ab^t + ba^T)(ab^T + ba^T) =
ab^Tab^T + ab^Tba^T + ba^Tab^T + ba^Tba^T = \\
\hspace{3mm}\\
\big\{a^Tb = 0, \hspace{3mm} b^Ta = 0 \big\} =
ab^Tba^T + ba^Tab^T =
|b|^2aa^T + |a|^2bb^T
\end{split}\]</div>
<p>We have the following result:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
|b|^2aa^Tv + |a|^2bb^Tv = \sigma^2 v;\\
|b|^2aa^Tu + |a|^2bb^Tu = \sigma^2 u
\end{split}\]</div>
<p>We can see that <span class="math notranslate nohighlight">\(v\)</span> and <span class="math notranslate nohighlight">\(u\)</span> can be vectors collinear to <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> respectively:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
|b|^2aa^T\alpha a + |a|^2bb^T\alpha a = \sigma^2 \alpha a; \\
|b|^2|a|^2\alpha a = \sigma^2 \alpha a;\\
|b||a| = \sigma
\end{split}\]</div>
<p>The same is true for <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(b\)</span>.</p>
<p>We have one degenerate <span class="math notranslate nohighlight">\(\sigma\)</span> and two corresponding singular vectors of unit length <span class="math notranslate nohighlight">\(v = \frac{a}{|a|}\)</span> and <span class="math notranslate nohighlight">\(u = \frac{b}{|b|}\)</span>.</p>
<p>So, the matrix <span class="math notranslate nohighlight">\(U\)</span> will consist of vectors <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> and the matrix <span class="math notranslate nohighlight">\(V\)</span> will consist of the same vectors. Matrix <span class="math notranslate nohighlight">\(\Sigma\)</span> will contain <span class="math notranslate nohighlight">\(\sigma_{1}^{1} = \sigma_{2}^{2} = |a||b|\)</span> and other elements will be zero.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A little clarification:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
ab^T + ba^T = u_1\sigma_1v_1^T + u_2\sigma_2v_2^T;\\
u_1 = a/\sigma_1, u_2 = b/\sigma_1, v_1^T = b^T/\sigma_2, v_2 = a^T/\sigma_2;\\
u_1 = v_2 = a/|a|, \\
u_2 = v_1 = b/|b|, \\
\sigma_1 = \sigma_2 = |a||b|
\end{split}\]</div>
<p>Then</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}
\Sigma = 
\begin{bmatrix}
|a||b| &amp; 0 &amp; \cdots \\
0 &amp; |a||b| &amp; \cdots \\
\vdots &amp; \vdots &amp; \ddots
\end{bmatrix}, \\
\hspace{3mm}\end{split}\\\begin{split}U =
\begin{bmatrix}\frac{a}{|a|} &amp; \frac{b}{|b|} &amp; \cdots\end{bmatrix}, \\
\hspace{3mm}\end{split}\\V =
\begin{bmatrix}
\frac{b}{|b|} &amp; \frac{a}{|a|} &amp; \cdots\end{bmatrix}
\end{aligned}\end{align} \]</div>
</div>
</div>
</div>
<div class="section" id="problem-5">
<h2>Problem 5<a class="headerlink" href="#problem-5" title="Permalink to this headline">¶</a></h2>
<p>For the matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
0 &amp; 1 &amp; 1\\
1 &amp; 0 &amp; 1\\
0 &amp; 1 &amp; 1\\
1 &amp; 0 &amp; 1
\end{bmatrix},
\end{split}\]</div>
<p><strong>(a)</strong> using SVD, find the orthonormal basis for the column space, <span class="math notranslate nohighlight">\(C(A)\)</span>, and complete it with the basis for the left nullspace, <span class="math notranslate nohighlight">\(N(A^T)\)</span>, to form a basis for <span class="math notranslate nohighlight">\(\mathbb{R}^4\)</span>. Write down the <span class="math notranslate nohighlight">\(4 \times 4\)</span> orthogonal matrix <span class="math notranslate nohighlight">\(U\)</span>.</p>
<p><strong>(b)</strong> Also using SVD, find the orthonormal basis for the row space, <span class="math notranslate nohighlight">\(R(A)\)</span>, and complete it with the basis for the nullspace, <span class="math notranslate nohighlight">\(N(A)\)</span>, to form a basis for <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>. Write down the <span class="math notranslate nohighlight">\(3 \times 3\)</span> orthogonal matrix <span class="math notranslate nohighlight">\(V\)</span>.</p>
<p><strong>(c)</strong> Write the full SVD <span class="math notranslate nohighlight">\(A = U\Sigma V^T\)</span></p>
<p><strong>(d)</strong> What is the best rank-1 approximation of <span class="math notranslate nohighlight">\(A\)</span>?</p>
<div class="section" id="id9">
<h3>Solution<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>This is a rank-2 matrix.</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(A^TA = V\Sigma ^T \Sigma V^T\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
A^T A =
\begin{bmatrix}
2 &amp; 0 &amp; 2\\
0 &amp; 2 &amp; 2\\
2 &amp; 2 &amp; 4
\end{bmatrix}
\end{split}\]</div>
<p>Eigenvalues:</p>
<div class="math notranslate nohighlight">
\[
\lambda_1 = 6, \hspace{3mm} \lambda_2 = 2, \hspace{3mm} \lambda_3 = 0
\]</div>
<p>and singular values are:</p>
<div class="math notranslate nohighlight">
\[
\sigma_1 = \sqrt{6}, \hspace{3mm} \sigma_2 = \sqrt{2}
\]</div>
<p>Normalized eigenvectors:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
v_1 = 
\begin{bmatrix}
  \sqrt{6}/6\\
  \sqrt{6}/6\\
  \sqrt{6}/3
\end{bmatrix}
, \hspace{3mm}
v_2 = 
\begin{bmatrix}
  -\sqrt{2}/2\\
  \sqrt{2}/2\\
  0
\end{bmatrix}
, \hspace{3mm}
v_3 = 
\begin{bmatrix}
  -\sqrt{3}/3\\
  -\sqrt{3}/3\\
  \sqrt{3}/3
\end{bmatrix}
\end{split}\]</div>
<p>So, the orthonormal basis for the row space <span class="math notranslate nohighlight">\(R(A)\)</span> is <span class="math notranslate nohighlight">\(\Big[v_1, v_2\Big]\)</span>, and the basis for the left null space <span class="math notranslate nohighlight">\(N(A^T)\)</span> is <span class="math notranslate nohighlight">\(\Big[v_3\Big]\)</span></p>
<ol class="simple">
<li><p>Now let’s find <span class="math notranslate nohighlight">\(U\)</span>: <span class="math notranslate nohighlight">\(AA^T = U\Sigma V^TV\Sigma^T U = U \Sigma \Sigma^T U^T\)</span></p></li>
</ol>
<p>Since <span class="math notranslate nohighlight">\(\Sigma^T = \Sigma\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}AA^T =
\begin{bmatrix}
  2 &amp; 1 &amp; 2 &amp; 1\\
  1 &amp; 2 &amp; 1 &amp; 2\\
  2 &amp; 1 &amp; 2 &amp; 1\\
  1 &amp; 2 &amp; 1 &amp; 2\\
\end{bmatrix}
\end{split}\]</div>
<p>Eigenvalues:</p>
<div class="math notranslate nohighlight">
\[
\varphi_1 = 6, \hspace{3mm} \varphi_2 = 2, \hspace{3mm} \varphi_3 = \varphi_4 = 0
\]</div>
<p>and singular values are (obviously the same):</p>
<div class="math notranslate nohighlight">
\[
\sigma_1 = \sqrt{6}, \hspace{3mm} \sigma_2 = \sqrt{2}
\]</div>
<p>Normalized eigenvectors:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
u_1 =
\begin{bmatrix}
  1/2\\
  1/2\\
  1/2\\
  1/2\\
\end{bmatrix}
, \hspace{3mm}
u_2 = 
\begin{bmatrix}
  -1/2\\
  1/2\\
  -1/2\\
  1/2\\
\end{bmatrix}
, \hspace{3mm} 
u_3 =
\begin{bmatrix}
  -\sqrt{2}/2\\
  0\\
  \sqrt{2}/2\\
  0\\
\end{bmatrix}
, \hspace{3mm}
u_4 = 
\begin{bmatrix}
  0\\
  -\sqrt{2}/2\\
  0\\
  \sqrt{2}/2\\
\end{bmatrix}
\end{split}\]</div>
<p>Column space of <span class="math notranslate nohighlight">\(A\)</span> is <span class="math notranslate nohighlight">\(\Big[u_1, u_2\Big]\)</span></p>
<p>The basis for the nullspace <span class="math notranslate nohighlight">\(N(A)\)</span> will be the remaining vectors, <span class="math notranslate nohighlight">\(\Big[u_3, u_4\Big]\)</span>.</p>
<p>Let’s write down the full SVD (with respect to the order of descent of the <span class="math notranslate nohighlight">\(\sigma\)</span>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
U = 
\begin{bmatrix}
1/2 &amp; -1/2 &amp; -\sqrt{2}/2 &amp; 0  \\
1/2 &amp; 1/2 &amp; 0 &amp; -\sqrt{2}/2 \\
1/2 &amp; -1/2 &amp; \sqrt{2}/2 &amp; 0 \\
1/2 &amp; 1/2 &amp; 0  &amp; \sqrt{2}/2 \\
\end{bmatrix}, \\
\hspace{3mm}\\
\Sigma =
\begin{bmatrix}
\sqrt{6} &amp; 0 &amp; 0 \\
0 &amp; \sqrt{2} &amp; 0 \\
0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 \\
\end{bmatrix},\\
\hspace{3mm}\\
V = 
\begin{bmatrix}
\sqrt{6}/6 &amp; -\sqrt{2}/2 &amp; -\sqrt{3}/3\\ 
\sqrt{6}/6 &amp; \sqrt{2}/2 &amp; -\sqrt{3}/3\\
\sqrt{6}/3 &amp; 0 &amp; \sqrt{3}/3
\end{bmatrix}
\end{split}\]</div>
<p>Then the best rank-1 approximation of <span class="math notranslate nohighlight">\(A\)</span> will be <span class="math notranslate nohighlight">\(u_1 \sigma_1 v_1^T\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A^{(1)} = 
\begin{bmatrix}
  1/2 &amp; 1/2 &amp; 1\\
  1/2 &amp; 1/2 &amp; 1\\
  1/2 &amp; 1/2 &amp; 1\\
  1/2 &amp; 1/2 &amp; 1\\
\end{bmatrix}.
\end{split}\]</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="ProblemSet2.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Problem Set 2</p>
            </div>
        </a>
    </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Arseniy Buchnev<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>